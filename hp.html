<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>GUMI Life Battery | 14H Health Mode</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        body { background: #000; color: #fff; font-family: sans-serif; text-align: center; display: flex; align-items: center; justify-content: center; height: 100vh; margin: 0; overflow: hidden; }
        .container { width: 90%; max-width: 450px; padding: 40px; border: 2px solid #111; border-radius: 30px; background: #050505; position: relative; }
        
        /* ãƒãƒƒãƒ†ãƒªãƒ¼ã®ãƒ‡ã‚¶ã‚¤ãƒ³ */
        .battery-case { width: 100%; height: 70px; border: 4px solid #fff; border-radius: 15px; position: relative; padding: 5px; box-sizing: border-box; }
        .battery-case::after { content: ''; position: absolute; right: -15px; top: 18px; width: 10px; height: 25px; background: #fff; border-radius: 0 5px 5px 0; }
        .battery-level { height: 100%; width: 100%; background: #10b981; transition: 0.5s; }
        
        .status-text { font-size: 60px; font-weight: bold; margin: 10px 0; }
        
        /* æ“ä½œãƒœã‚¿ãƒ³ */
        .controls { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 20px; }
        button { padding: 18px; border-radius: 15px; border: none; cursor: pointer; font-weight: bold; font-size: 14px; transition: 0.2s; }
        button:active { transform: scale(0.95); }
        
        .btn-eat { background: #f472b6; color: white; grid-column: span 2; box-shadow: 0 4px #be185d; }
        .btn-eat:disabled { background: #111; color: #333; cursor: not-allowed; box-shadow: none; }
        .btn-little { background: #475569; color: white; box-shadow: 0 4px #1e293b; }
        .btn-tired { background: #1e293b; color: #ef4444; border: 1px solid #7f1d1d; box-shadow: 0 4px #000; }

        /* ğŸ’¤ ãŠã‚„ã™ã¿ç”»é¢ */
        #sleep-ui { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #000; flex-direction: column; align-items: center; justify-content: center; z-index: 999; }
        
        /* ğŸ›Œ å®‰çœ ã‚’èª˜ã†ã€Œã˜ã‚ã€œã£ã€ã¨ã—ãŸ4ç§’ç‚¹æ»… */
        .sleep-msg-big { 
            font-size: 40px; 
            font-weight: bold; 
            color: #6366f1; 
            line-height: 1.6;
            animation: sleep-slow 4s infinite ease-in-out; 
        }

        @keyframes sleep-slow { 
            0%, 100% { color: #6366f1; opacity: 1; text-shadow: 0 0 15px #6366f1; } 
            50% { color: #1e1b4b; opacity: 0.2; text-shadow: none; } 
        }

        /* ãƒãƒƒãƒ†ãƒªãƒ¼ãƒ”ãƒ³ãƒã®ç‚¹æ»… */
        @keyframes low-blink { 0%, 100% { background: #ef4444; } 50% { background: #450a0a; } }
        .low-battery { animation: low-blink 0.8s infinite !important; }
    </style>
</head>
<body>

<div class="container" id="ui">
    <div class="battery-case"><div id="bar" class="battery-level"></div></div>
    <div id="percent" class="status-text">100%</div>
    <div class="controls">
        <button id="eatBtn" class="btn-eat" onclick="eat()">é£¯ã‚’é£Ÿã† (+15%)</button>
        <button class="btn-little" onclick="tired(5)">ã¡ã‚‡ã£ã¨ç–²ã‚ŒãŸ (-5%)</button>
        <button class="btn-tired" onclick="tired(10)">ç–²ã‚Œå€’ã—ãŸãƒ¼ï¼ (-10%)</button>
    </div>
    <p style="margin-top:25px; color:#222; font-size:10px;">AM 05:00 AUTO RECOVERY | 20:00 SHUTDOWN</p>
</div>

<div id="sleep-ui">
    <div class="sleep-msg-big">
        ä»Šæ—¥ã¯ã‚‚ã†å¯ãŸæ–¹ãŒã„ã„ã€‚<br>ãŠã‚„ã™ã¿ãƒ¼ ğŸ’¤
    </div>
</div>

<script>
    let hp = 100;
    let mealFlags = { morning: false, lunch: false, dinner: false };
    let lastResetDate = localStorage.getItem('gumi_public_v1') || "";

    function update() {
        const now = new Date();
        const hour = now.getHours();
        const min = now.getMinutes();
        const timeDec = hour + (min / 60);
        const todayStr = now.toDateString();

        // æœ5æ™‚ãƒªã‚»ãƒƒãƒˆåˆ¤å®š
        if (hour >= 5 && lastResetDate !== todayStr) {
            hp = 100; mealFlags = { morning: false, lunch: false, dinner: false };
            localStorage.setItem('gumi_public_v1', todayStr);
            document.getElementById('ui').style.display = 'block';
            document.getElementById('sleep-ui').style.display = 'none';
        }

        // ğŸš¨ å¤œ8æ™‚(20:00) å¼·åˆ¶çµ‚äº†åˆ¤å®š
        if (timeDec >= 20.0 || hp <= 0) {
            hp = 0;
            document.getElementById('ui').style.display = 'none';
            document.getElementById('sleep-ui').style.display = 'flex';
        }

        const barElement = document.getElementById('bar');
        barElement.style.width = hp + "%";
        document.getElementById('percent').innerText = Math.floor(hp) + "%";

        // é£Ÿäº‹ãƒœã‚¿ãƒ³åˆ¶å¾¡
        let canEat = (timeDec <= 8) || (timeDec >= 11 && timeDec <= 13.5) || (timeDec >= 18 && timeDec <= 20);
        let type = (timeDec <= 8) ? "morning" : (timeDec >= 11 && timeDec <= 13.5) ? "lunch" : "dinner";
        document.getElementById('eatBtn').disabled = !canEat || mealFlags[type];

        // 20%ä»¥ä¸‹ã§ç‚¹æ»…
        if (hp <= 20 && hp > 0) {
            barElement.classList.add('low-battery');
        } else {
            barElement.classList.remove('low-battery');
            barElement.style.background = hp <= 50 ? "#fbbf24" : "#10b981";
        }
    }

    function eat() { 
        hp += 15; 
        const h = new Date().getHours() + (new Date().getMinutes()/60);
        let type = (h <= 8) ? "morning" : (h >= 11 && h <= 13.5) ? "lunch" : "dinner";
        mealFlags[type] = true; 
        update(); 
    }
    function tired(val) { hp -= val; update(); }

    // ğŸ•’ 6åˆ†ã«1%æ¸›å°‘
    setInterval(() => { if (hp > 0) { hp -= 1; update(); } }, 360000);
    setInterval(update, 1000); 
    update();
</script>
</body>
</html>
